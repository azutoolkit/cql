import{_ as e,o as n,c as l,x as s,a,S as t}from"./app.19d9338b.js";import"./chunks/theme.a19b6002.js";const F=JSON.parse('{"title":"Cql::Migrator","description":"","frontmatter":{"title":"Cql::Migrator"},"headers":[{"level":2,"title":"Constants","slug":"constants","link":"#constants","children":[{"level":3,"title":"Log","slug":"log","link":"#log","children":[]}]},{"level":2,"title":"Constructors","slug":"constructors","link":"#constructors","children":[{"level":3,"title":"def new(schema : Schema)","slug":"def-new-schema-schema","link":"#def-new-schema-schema","children":[]}]},{"level":2,"title":"Class Methods","slug":"class-methods","link":"#class-methods","children":[{"level":3,"title":"def migrations","slug":"def-migrations","link":"#def-migrations","children":[]},{"level":3,"title":"def migrations=(migrations : Array(Migration.class))","slug":"def-migrations-migrations-array-migration-class","link":"#def-migrations-migrations-array-migration-class","children":[]}]},{"level":2,"title":"Instance Methods","slug":"instance-methods","link":"#instance-methods","children":[{"level":3,"title":"def applied_migrations","slug":"def-applied-migrations","link":"#def-applied-migrations","children":[]},{"level":3,"title":"def down(steps : Int32 = Migrator.migrations.size)","slug":"def-down-steps-int32-migrator-migrations-size","link":"#def-down-steps-int32-migrator-migrations-size","children":[]},{"level":3,"title":"def down_to(version : Int64)","slug":"def-down-to-version-int64","link":"#def-down-to-version-int64","children":[]},{"level":3,"title":"def last","slug":"def-last","link":"#def-last","children":[]},{"level":3,"title":"def pending_migrations","slug":"def-pending-migrations","link":"#def-pending-migrations","children":[]},{"level":3,"title":"def print_applied_migrations","slug":"def-print-applied-migrations","link":"#def-print-applied-migrations","children":[]},{"level":3,"title":"def print_pending_migrations","slug":"def-print-pending-migrations","link":"#def-print-pending-migrations","children":[]},{"level":3,"title":"def print_rolled_back_migrations(m : Array(Migration.class))","slug":"def-print-rolled-back-migrations-m-array-migration-class","link":"#def-print-rolled-back-migrations-m-array-migration-class","children":[]},{"level":3,"title":"def redo","slug":"def-redo","link":"#def-redo","children":[]},{"level":3,"title":"def repo","slug":"def-repo","link":"#def-repo","children":[]},{"level":3,"title":"def rollback(steps : Int32 = 1)","slug":"def-rollback-steps-int32-1","link":"#def-rollback-steps-int32-1","children":[]},{"level":3,"title":"def schema","slug":"def-schema","link":"#def-schema","children":[]},{"level":3,"title":"def up(steps : Int32 = Migrator.migrations.size)","slug":"def-up-steps-int32-migrator-migrations-size","link":"#def-up-steps-int32-migrator-migrations-size","children":[]},{"level":3,"title":"def up_to(version : Int64)","slug":"def-up-to-version-int64","link":"#def-up-to-version-int64","children":[]}]}],"relativePath":"main/Cql/Migrator.md","lastUpdated":1723931959000}'),i={name:"main/Cql/Migrator.md"},o=s("div",null,[s("h1",{id:"class-cql-migrator",tabindex:"-1"},[a("class Cql::Migrator "),s("a",{class:"header-anchor",href:"#class-cql-migrator","aria-hidden":"true"},"#")]),s("p",null,[s("code",null,"Reference"),a(" < "),s("code",null,"Object")]),s("p",null,[a("The "),s("code",null,"Migrator"),a(" class is used to manage migrations and provides methods to apply, rollback, and redo migrations. The "),s("code",null,"Migrator"),a(" class also provides methods to list applied and pending migrations. "),s("strong",null,"Example"),a(" Creating a new migrator")]),s("div",{class:"language-crystal"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"crystal"),s("pre",{"v-pre":"",class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#BABED8"}},"schema "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#BABED8"}}," "),s("span",{style:{color:"#FFCB6B"}},"Cql"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#FFCB6B"}},"Schema"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"build"),s("span",{style:{color:"#89DDFF"}},"(:northwind,"),s("span",{style:{color:"#BABED8"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"sqlite3://db.sqlite3"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#BABED8"}}," "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"do "),s("span",{style:{color:"#89DDFF"}},"|"),s("span",{style:{color:"#BABED8"}},"s"),s("span",{style:{color:"#89DDFF"}},"|")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#BABED8"}},"  table "),s("span",{style:{color:"#89DDFF"}},":schema_migrations"),s("span",{style:{color:"#BABED8"}}," "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"do")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#BABED8"}},"    primary "),s("span",{style:{color:"#89DDFF"}},":id,"),s("span",{style:{color:"#BABED8"}}," "),s("span",{style:{color:"#FFCB6B"}},"Int32")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#BABED8"}},"    column "),s("span",{style:{color:"#89DDFF"}},":name,"),s("span",{style:{color:"#BABED8"}}," "),s("span",{style:{color:"#FFCB6B"}},"String")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#BABED8"}},"    column "),s("span",{style:{color:"#89DDFF"}},":version,"),s("span",{style:{color:"#BABED8"}}," "),s("span",{style:{color:"#FFCB6B"}},"Int64"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#BABED8"}}," "),s("span",{style:{color:"#89DDFF"}},"index:"),s("span",{style:{color:"#BABED8"}}," "),s("span",{style:{color:"#FF9CAC"}},"true"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#BABED8"}}," "),s("span",{style:{color:"#89DDFF"}},"unique:"),s("span",{style:{color:"#BABED8"}}," "),s("span",{style:{color:"#FF9CAC"}},"true")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#BABED8"}},"    timestamps")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#BABED8"}},"  "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"end")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"end")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#BABED8"}},"migrator "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#BABED8"}}," "),s("span",{style:{color:"#FFCB6B"}},"Cql"),s("span",{style:{color:"#89DDFF"}},"::"),s("span",{style:{color:"#FFCB6B"}},"Migrator"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"new"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#BABED8"}},"schema"),s("span",{style:{color:"#89DDFF"}},")")]),a(`
`),s("span",{class:"line"})])])]),s("p",null,[s("strong",null,"Example"),a(" Applying migrations")]),s("div",{class:"language-crystal"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"crystal"),s("pre",{"v-pre":"",class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#BABED8"}},"migrator"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#BABED8"}},"up")]),a(`
`),s("span",{class:"line"})])])]),s("details",{class:"details custom-block"},[s("summary",null,"Table of Contents"),s("nav",{class:"table-of-contents"},[s("ul",null,[s("li",null,[s("a",{href:"#constants"},"Constants"),s("ul",null,[s("li",null,[s("a",{href:"#log"},"Log")])])]),s("li",null,[s("a",{href:"#constructors"},"Constructors"),s("ul",null,[s("li",null,[s("a",{href:"#def-new-schema-schema"},"def new(schema : Schema)")])])]),s("li",null,[s("a",{href:"#class-methods"},"Class Methods"),s("ul",null,[s("li",null,[s("a",{href:"#def-migrations"},"def migrations")]),s("li",null,[s("a",{href:"#def-migrations-migrations-array-migration-class"},"def migrations=(migrations : Array(Migration.class))")])])]),s("li",null,[s("a",{href:"#instance-methods"},"Instance Methods"),s("ul",null,[s("li",null,[s("a",{href:"#def-applied-migrations"},"def applied_migrations")]),s("li",null,[s("a",{href:"#def-down-steps-int32-migrator-migrations-size"},"def down(steps : Int32 = Migrator.migrations.size)")]),s("li",null,[s("a",{href:"#def-down-to-version-int64"},"def down_to(version : Int64)")]),s("li",null,[s("a",{href:"#def-last"},"def last")]),s("li",null,[s("a",{href:"#def-pending-migrations"},"def pending_migrations")]),s("li",null,[s("a",{href:"#def-print-applied-migrations"},"def print_applied_migrations")]),s("li",null,[s("a",{href:"#def-print-pending-migrations"},"def print_pending_migrations")]),s("li",null,[s("a",{href:"#def-print-rolled-back-migrations-m-array-migration-class"},"def print_rolled_back_migrations(m : Array(Migration.class))")]),s("li",null,[s("a",{href:"#def-redo"},"def redo")]),s("li",null,[s("a",{href:"#def-repo"},"def repo")]),s("li",null,[s("a",{href:"#def-rollback-steps-int32-1"},"def rollback(steps : Int32 = 1)")]),s("li",null,[s("a",{href:"#def-schema"},"def schema")]),s("li",null,[s("a",{href:"#def-up-steps-int32-migrator-migrations-size"},"def up(steps : Int32 = Migrator.migrations.size)")]),s("li",null,[s("a",{href:"#def-up-to-version-int64"},"def up_to(version : Int64)")])])])])])])],-1),r=t(`<h2 id="constants" tabindex="-1">Constants <a class="header-anchor" href="#constants" aria-hidden="true">#</a></h2><h3 id="log" tabindex="-1">Log <a class="header-anchor" href="#log" aria-hidden="true">#</a></h3><div class="language-crystal"><button title="Copy Code" class="copy"></button><span class="lang">crystal</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">Log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">for</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">self</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div><h2 id="constructors" tabindex="-1">Constructors <a class="header-anchor" href="#constructors" aria-hidden="true">#</a></h2><h3 id="def-new-schema-schema" tabindex="-1">def new<code>(schema : Schema)</code> <a class="header-anchor" href="#def-new-schema-schema" aria-hidden="true">#</a></h3><h2 id="class-methods" tabindex="-1">Class Methods <a class="header-anchor" href="#class-methods" aria-hidden="true">#</a></h2><h3 id="def-migrations" tabindex="-1">def migrations <a class="header-anchor" href="#def-migrations" aria-hidden="true">#</a></h3><h3 id="def-migrations-migrations-array-migration-class" tabindex="-1">def migrations=<code>(migrations : Array(Migration.class))</code> <a class="header-anchor" href="#def-migrations-migrations-array-migration-class" aria-hidden="true">#</a></h3><h2 id="instance-methods" tabindex="-1">Instance Methods <a class="header-anchor" href="#instance-methods" aria-hidden="true">#</a></h2><h3 id="def-applied-migrations" tabindex="-1">def applied_migrations <a class="header-anchor" href="#def-applied-migrations" aria-hidden="true">#</a></h3><p>Returns the applied migrations.</p><ul><li><strong>@return</strong> [Array(MigrationRecord)] <strong>Example</strong> Listing applied migrations</li></ul><div class="language-crystal"><button title="Copy Code" class="copy"></button><span class="lang">crystal</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">migrator</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">applied_migrations</span></span>
<span class="line"></span></code></pre></div><h3 id="def-down-steps-int32-migrator-migrations-size" tabindex="-1">def down<code>(steps : Int32 = Migrator.migrations.size)</code> <a class="header-anchor" href="#def-down-steps-int32-migrator-migrations-size" aria-hidden="true">#</a></h3><p>Rolls back the last migration.</p><ul><li><strong>@param</strong> steps [Int32] the number of migrations to roll back (default: 1) <strong>Example</strong> Rolling back migrations</li></ul><div class="language-crystal"><button title="Copy Code" class="copy"></button><span class="lang">crystal</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">migrator</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">down</span></span>
<span class="line"></span></code></pre></div><h3 id="def-down-to-version-int64" tabindex="-1">def down_to<code>(version : Int64)</code> <a class="header-anchor" href="#def-down-to-version-int64" aria-hidden="true">#</a></h3><p>Rolls back to a specific migration version.</p><ul><li><strong>@param</strong> version [Int64] the version to roll back to <strong>Example</strong> Rolling back to a specific version</li></ul><div class="language-crystal"><button title="Copy Code" class="copy"></button><span class="lang">crystal</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">migrator</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">down_to</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1_i64</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="def-last" tabindex="-1">def last <a class="header-anchor" href="#def-last" aria-hidden="true">#</a></h3><p>Returns the last migration. <strong>Example</strong> Listing the last migration</p><div class="language-crystal"><button title="Copy Code" class="copy"></button><span class="lang">crystal</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">migrator</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">last</span></span>
<span class="line"></span></code></pre></div><p>@return [Migration.class | Nil]</p><h3 id="def-pending-migrations" tabindex="-1">def pending_migrations <a class="header-anchor" href="#def-pending-migrations" aria-hidden="true">#</a></h3><p>Returns the pending migrations.</p><ul><li><strong>@return</strong> [Array(MigrationRecord)] <strong>Example</strong> Listing pending migrations</li></ul><div class="language-crystal"><button title="Copy Code" class="copy"></button><span class="lang">crystal</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">migrator</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">pending_migrations</span></span>
<span class="line"></span></code></pre></div><h3 id="def-print-applied-migrations" tabindex="-1">def print_applied_migrations <a class="header-anchor" href="#def-print-applied-migrations" aria-hidden="true">#</a></h3><p>Prints the applied migrations. <strong>Example</strong> Listing applied migrations</p><div class="language-crystal"><button title="Copy Code" class="copy"></button><span class="lang">crystal</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">migrator</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">print_applied_migrations</span></span>
<span class="line"></span></code></pre></div><h3 id="def-print-pending-migrations" tabindex="-1">def print_pending_migrations <a class="header-anchor" href="#def-print-pending-migrations" aria-hidden="true">#</a></h3><p>Prints the pending migrations. <strong>Example</strong> Listing pending migrations</p><div class="language-crystal"><button title="Copy Code" class="copy"></button><span class="lang">crystal</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">migrator</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">print_pending_migrations</span></span>
<span class="line"></span></code></pre></div><h3 id="def-print-rolled-back-migrations-m-array-migration-class" tabindex="-1">def print_rolled_back_migrations<code>(m : Array(Migration.class))</code> <a class="header-anchor" href="#def-print-rolled-back-migrations-m-array-migration-class" aria-hidden="true">#</a></h3><p>Prints the rolled back migrations.</p><ul><li><strong>@param</strong> m [Array(Migration.class)] the migrations to print</li><li><strong>@return</strong> [Nil] <strong>Example</strong> Listing rolled back migrations</li></ul><div class="language-crystal"><button title="Copy Code" class="copy"></button><span class="lang">crystal</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">migrator</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">print_rolled_back_migrations</span></span>
<span class="line"></span></code></pre></div><h3 id="def-redo" tabindex="-1">def redo <a class="header-anchor" href="#def-redo" aria-hidden="true">#</a></h3><p>Redoes the last migration. <strong>Example</strong> Redoing migrations</p><div class="language-crystal"><button title="Copy Code" class="copy"></button><span class="lang">crystal</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">migrator</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">redo</span></span>
<span class="line"></span></code></pre></div><h3 id="def-repo" tabindex="-1">def repo <a class="header-anchor" href="#def-repo" aria-hidden="true">#</a></h3><h3 id="def-rollback-steps-int32-1" tabindex="-1">def rollback<code>(steps : Int32 = 1)</code> <a class="header-anchor" href="#def-rollback-steps-int32-1" aria-hidden="true">#</a></h3><p>Rolls back the last migration.</p><ul><li><strong>@param</strong> steps [Int32] the number of migrations to roll back (default: 1) <strong>Example</strong> Rolling back migrations</li></ul><div class="language-crystal"><button title="Copy Code" class="copy"></button><span class="lang">crystal</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">migrator</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">rollback</span></span>
<span class="line"></span></code></pre></div><h3 id="def-schema" tabindex="-1">def schema <a class="header-anchor" href="#def-schema" aria-hidden="true">#</a></h3><h3 id="def-up-steps-int32-migrator-migrations-size" tabindex="-1">def up<code>(steps : Int32 = Migrator.migrations.size)</code> <a class="header-anchor" href="#def-up-steps-int32-migrator-migrations-size" aria-hidden="true">#</a></h3><p>Applies the pending migrations.</p><ul><li><strong>@param</strong> steps [Int32] the number of migrations to apply (default: all) <strong>Example</strong> Applying migrations</li></ul><div class="language-crystal"><button title="Copy Code" class="copy"></button><span class="lang">crystal</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">migrator</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">up</span></span>
<span class="line"></span></code></pre></div><h3 id="def-up-to-version-int64" tabindex="-1">def up_to<code>(version : Int64)</code> <a class="header-anchor" href="#def-up-to-version-int64" aria-hidden="true">#</a></h3><p>Applies migrations up to a specific version.</p><ul><li><strong>@param</strong> version [Int64] the version to apply up to <strong>Example</strong> Applying to a specific version</li></ul><div class="language-crystal"><button title="Copy Code" class="copy"></button><span class="lang">crystal</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">migrator</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">up_to</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1_i64</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div><p>:::</p>`,57),p=[o,r];function c(d,g,h,m,f,u){return n(),l("div",null,p)}const B=e(i,[["render",c]]);export{F as __pageData,B as default};
